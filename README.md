# majicom

> [!NOTE]
> このプロジェクトは、[**"改良版"まじん式プロンプト！**](https://note.com/majin_108/n/nd11d1f88a939) が出力するGASのうち
> 「固定部分」と**互換性**のあるGASプログラムをライブラリ化できるよう開発したものです。
>
> 偉大な原案である、まじん様作のプロンプトが出力する「可変部分」(const slideData)さえ受け取ればスライドを作成できます。

**Googleスライドを爆速で生成するGoogle Apps Script (GAS) ライブラリ**


---

## 概要

これは、AI（Geminiなど）と連携してGoogleスライドを高速に生成するためのツールセットです。

従来のプロンプトが抱えていた「**生成に時間がかかる**」「**既存のデザインテンプレートを適用しにくい**」といった課題を、アーキテクチャを根本から見直すことで解決しました。

* 解決するために一式を開発しました
* 「まじん式プロンプト」が出力するGASのうち固定部分と互換性のあるGASプログラム、、、長いので
	* 「まじん式」x「互換(compatible)」で「majicom（まじコン（仮称））」としています

---

## 主な特徴 ✨

* **高速なスライド生成**: AIはスライドの構成データ（`slideData`）の出力だけで済むため、処理時間が短縮できます
	* GAS側で、そのデータをもとにスライドを組み立てます
	* **※プロンプトで可変部分だけ出力する改造は自己責任で**🙇
* **柔軟なデザイン適用**: Googleスライドのテーマやレイアウト機能を活用するため、既存のテンプレートにも容易に適用できます（詳細は「カスタマイズのヒント」参照）
	* すべての設定を外部から変更可能です、スライドのテーマに応じた色やクロージングのメッセージを変えてみたり
* **スライドっぽいスライド生成**: 箇条書きやコネクタ・矢印を導入しました
* **高いメンテナンス性**: スライド生成のロジックをライブラリ化できるため、効率的に機能改善やバグ修正できます

---

## ファイル構成 📂

リポジトリには、以下の主要なファイルが含まれています。

* `majicom.js`: スライドを生成するプログラム本体（ライブラリ）です
* `スライド用のGAS.js`: あなたのGoogleスライドにコピー＆ペーストして使用するスクリプトです

---

## 使い方 🚀

### 1. 初回セットアップ

#### STEP 1: Googleスライドの準備
1.  あなたのGoogleスライドを開き、メニューバーから **【拡張機能】→【Apps Script】** を選び、スクリプトエディタを開きます。
2.  ファイル一覧の横にある`+`アイコンから、「スクリプト」を**2つ**追加します。
3.  1つ目のファイルに、リポジトリの`スライド用のGAS.js`の中身をすべてコピー＆ペーストします。（ファイル名は`main.gs`などが分かりやすいです）
4.  2つ目のファイルの名前を`const.gs`に変更し、中身は空のままにしておきます。（ここは後でAIが作った「設計図」を貼る場所になります）

#### STEP 2: ライブラリ (`majicom.js`) のセットアップ
次に、プログラム本体をセットアップします。方法は2つあります。

##### 🚀 方法A： かんたん！スライドに直接埋め込む方法
**（まずはお試し・動作確認として）**
1.  リポジトリにある `majicom.js` の中身をすべてコピーします。
2.  スライドのスクリプトエディタで、`+`アイコンから新しいスクリプトファイルを作成し、`majicom.gs` のような名前を付けます。
3.  作成したファイルに、コピーしたコードをすべて貼り付けて、💾保存します。
> これで、あなたのスクリプトエディタには最終的に`main.gs`, `const.gs`, `majicom.gs`の3つのファイルが存在する状態になります。

##### 🔧 方法B：オススメ！ 自分or共有のライブラリとして使う方法
**（複数のスライドからライブラリ1つを共有して使えるオススメ設定）**
1.  Googleドライブで、新規にスタンドアロンスクリプトを作成します。
2.  リポジトリにある `majicom.js` の中身をすべてコピーし、作成したスクリプトに貼り付けて、💾保存します。
3.  スクリプトエディタの「歯車マーク **[プロジェクトの設定]** 」を選択し、表示される **「スクリプトID」** をコピーします。
	* ↑ここまでがライブラリ化の作業（ライブラリは閉じて大丈夫です）
	* ↓ここからはSTEP1のGoogleスライドでの作業
4.  スライド側のスクリプトエディタで、左側のメニューから「ライブラリ」の `+` を押し、コピーしたスクリプトIDを貼り付けてライブラリを連携させます。
5.  `main.gs` の `function create()` 内のコメントアウト（=実行されるプログラムのありか）を入れ替えます。
	* 12行目： `majicom.createPresentation(slideData, config, shape);` の先頭の `//` を消します
	* 9行目： `createPresentation(slideData, config, shape);` の前に `//` を追記して、💾保存します
> これで、あなたのスクリプトエディタには最終的に`main.gs`, `const.gs`の2つのファイルと、1つのライブラリが存在する状態になります。
> デプロイはお好みで・必要に応じて 実行ください。

#### STEP x: AIプロンプトの登録（※省略可、自己責任で）
* 「まじん式プロンプト」について、GASの可変部分(const slideData)だけ出力するよう修正します
	* 削除して良いと思われる部分 **「例・夢」** 
	* ※下から消さないと行がズレます
		* 7行目の 「ブループリント ... 禁じられています。」
		* 37行目の 「\*\*【GOOGLE ... そのまま出力し、」
		* 103行目の 「完全な全文 ... 唯一の差分が」
		* 111行目の「```javascript」は残して、
			* 269-303行の `const slideData = [` から `];` **「以外」**
* 修正したプロンプトをGeminiのGem等として登録します


### 2. スライドの作り方

1.  AIプロンプトを使い、スライドの「設計図」となるコード（`const slideData = [...]`）を出力させます。
2.  スライドのスクリプトエディタを開き、`const.gs` ファイルの中身を、出力された **「設計図」コードのみ（=他の部分は不要）** で完全に上書きし、💾保存します。
3.  スライドの画面に戻り、メニューバーから **【GASメニュー】→【🎨 スライドを生成】** をクリックすると、スライドが自動生成されます🎉

このスライドをコピー・流用することで、次回以降も再利用可能です。もしくは『テンプレート』として保存しておくとか。

> `main.gs`, `const.gs` 等の並び順は各ファイルの右の︙（三点リーダー）から変更できます。たぶん `const.gs` が先頭にあると「設計図」を貼りやすいです。

---

## カスタマイズのヒント

### スライドタイプと適用レイアウトについて
本ツールは、Googleスライドのテーマ機能に存在する **「レイアウト」** を基盤としてスライドを生成します。各スライドタイプ（`type`）と適用されるレイアウトの関係は以下の通りです。

#### ■ 基本スライド
* **`title`, `closing`**: 「**タイトル スライド**」レイアウトが適用されます
* **`section`**: 「**セクション ヘッダー**」レイアウトが適用されます

#### ■ 本文スライド
`content`や`kpi`など、上記以外の本文スライドはすべて **「空白」レイアウト** を基盤としています

なお（テーマ・）レイアウトの「プレースホルダ」は使えていないので、各レイアウトのプレースホルダは不要（=削除せねば）です。

ページ番号はお好みに応じて、、たぶん「空白」レイアウトにあると良いと思います。

> **Pro-Tip:** この仕様を利用し、テンプレートスライドのテーマ編集画面 **（[スライド] > [テーマを編集]）** から各レイアウトのデザイン（背景、ヘッダー・フッター 画像、ページ番号 等）を変更・管理することが可能です。

---

## ライセンス

このプロジェクトは、すべての権利を放棄したパブリックドメイン（The Unlicense）です。

* **完全に自由です。** 商用利用、改変、再配布など、ご自由にお使いください
* **利用、改変は自己責任でお願いします。** 本ソフトウェアを利用したことによる、いかなる損害についても作者は責任を負いません

詳細は`LICENSE`ファイルをご覧ください。

---

## Special Thanks 🙏

このツールの元となる偉大な「まじん式プロンプト」を生み出した **まじん様** に心からの敬意と感謝を捧げます。

**ゼロ**からGASとプロンプトを作成し **「プロンプト→GASとスライドで完結する」** コンセプトは、本当に尊敬・リスペクトしています。  
プロンプトが出力する可変部分を処理する、この **互換** ツールは「正解」があってこそ開発できたと思っています。  
（未実装・残り のスライドタイプの量と内容を見て、何度くじけそうになったことか。。）  

ステキな機能を公開してくださり、本当にありがとうございます。
